(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{1:function(e,a,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,a,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return a[t]}})}:function(e,a,t,r){void 0===r&&(r=t),e[r]=a[t]}),n=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||r(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),n(t(20),a),n(t(82),a)},2:function(e,a,t){e.exports=t.p+"static/media/svg-cards.5d232435.svg"},20:function(e,a,t){"use strict";var r=this&&this.__createBinding||(Object.create?function(e,a,t,r){void 0===r&&(r=t),Object.defineProperty(e,r,{enumerable:!0,get:function(){return a[t]}})}:function(e,a,t,r){void 0===r&&(r=t),e[r]=a[t]}),n=this&&this.__exportStar||function(e,a){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(a,t)||r(a,e,t)};Object.defineProperty(a,"__esModule",{value:!0}),n(t(81),a),n(t(37),a),n(t(36),a)},36:function(e,a,t){"use strict";var r;Object.defineProperty(a,"__esModule",{value:!0}),a.pointsHeld=a.isJoker=a.Values=void 0,function(e){e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.NINE=9]="NINE",e[e.TEN=10]="TEN",e[e.JACK=11]="JACK",e[e.QUEEN=12]="QUEEN",e[e.KING=13]="KING",e[e.ACE=14]="ACE",e[e.SMALL_JOKER=15]="SMALL_JOKER",e[e.BIG_JOKER=16]="BIG_JOKER"}(r=a.Values||(a.Values={})),a.isJoker=function(e){return e===r.SMALL_JOKER||e===r.BIG_JOKER},a.pointsHeld=function(e){return e===r.FIVE?5:e===r.TEN||e===r.KING?10:0}},37:function(e,a,t){"use strict";var r;Object.defineProperty(a,"__esModule",{value:!0}),a.isValidColor=a.Colors=void 0,function(e){e[e.HEART=1]="HEART",e[e.SPADE=2]="SPADE",e[e.CLUB=3]="CLUB",e[e.DIAMOND=4]="DIAMOND",e[e.JOKER=5]="JOKER"}(r=a.Colors||(a.Colors={})),a.isValidColor=function(e){return e===r.HEART||e===r.SPADE||e===r.CLUB||e===r.DIAMOND||e===r.JOKER}},38:function(e,a,t){},41:function(e,a,t){e.exports=t(88)},46:function(e,a,t){},47:function(e,a,t){},78:function(e,a){},81:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.Card=void 0;var r=t(36),n=t(37),c=function(){function e(e,a){if(!r.isJoker(e)&&!n.isValidColor(a))throw new Error("Every card must have a color!");if(r.isJoker(e)&&a&&a!==n.Colors.JOKER)throw new Error("Joker cards cannot have colors!");this._value=e,this._color=a||n.Colors.JOKER}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},enumerable:!1,configurable:!0}),e.prototype.isJoker=function(){return r.isJoker(this.value)},e.prototype.isSpecial=function(){return this.value===r.Values.FIVE||this.value===r.Values.TEN||this.value===r.Values.KING},e.prototype.isMaster=function(e,a){return this._color===e||this._color===n.Colors.JOKER||this._value===a},e.prototype.pointsHeld=function(){return r.pointsHeld(this.value)},e.prototype.toString=function(){return r.Values[this._value]+" "+(n.Colors[this._color]||"")},e}();a.Card=c},82:function(e,a,t){"use strict";var r=this&&this.__extends||function(){var e=function(a,t){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,a){e.__proto__=a}||function(e,a){for(var t in a)Object.prototype.hasOwnProperty.call(a,t)&&(e[t]=a[t])})(a,t)};return function(a,t){function r(){this.constructor=a}e(a,t),a.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();Object.defineProperty(a,"__esModule",{value:!0}),a.Game=void 0;var n=t(83),c=t(20),l=t(84),s=t(85),o=t(87),i=function(e){function a(a,t){var r=a[0],n=r[0],c=r[1],s=a[1],i=s[0],m=s[1],u=e.call(this)||this;if(u._players=[],u._currentRoundCards=[],u.roundCount=0,u.masterNumber=t,!n||!c||!i||!m)throw Error("The game must be started with four players, with two on each team!");var d=new l.Player(n),p=new l.Player(c),E=new l.Player(i),h=new l.Player(m);return u._teams=[new o.Team([d,p],"ATTACK"),new o.Team([E,h],"DEFEND")],u._players=[d,p,E,h],u}return r(a,e),a.prototype.start=function(){if(this.phase="DRAWING",this.emit("phaseChange",{phase:this.phase}),this.drawPile=new s.Deck,this._currentPlayer=this.players[Math.floor(4*Math.random())],"JOKER"===this.masterNumber)for(this.masterColor=c.Colors.JOKER;this.drawPile.length>6;)this.draw()},a.prototype.draw=function(){if("DRAWING"!==this.phase)throw Error("You cannot draw cards at this point!");var e=this.drawPile.draw();if(this._currentPlayer.hand=this._currentPlayer.hand.concat([e]),this.emit("draw",{player:this._currentPlayer.name,card:e}),6===this.drawPile.length){if(!this.masterColor){var a=this.drawPile.cards.map((function(e){return e.color}));this.masterColor=this.findMostDuplicates(a)}this.phase="TAKING",this.emit("phaseChange",{phase:this.phase})}this._currentPlayer=this.nextPlayer},a.prototype.setMasterColor=function(e){if("DRAWING"!==this.phase)throw Error("Master color can only be set while drawing!");if(e.value!==this.masterNumber)throw Error("You cannot declare a master color with this card!");for(this.masterColor=e.color;this.drawPile.length>6;)this.draw()},a.prototype.takeRemaining=function(e){if("TAKING"!==this.phase)throw Error("You cannot take remaining cards at this point!");var a=this.getPlayerByName(e);if(!a)throw Error("This player does not exist!");if("DEFEND"!==this.getPlayerTeam(a).role)throw Error("Only the defending team can take remaining cards!");var t=this.drawPile.takeRemaining();a.hand=a.hand.concat(t),this.emit("cardtake",{player:a.name,cards:t}),this.phase="PUTTING",this.emit("phaseChange",{phase:this.phase})},a.prototype.putDownHiddenCards=function(e,a){if("PUTTING"!==this.phase)throw Error("You cannot put down hidden cards at this point!");if(6!==a.length)throw Error("You must put down six cards!");if(a.reduce((function(e,a){return e+a.pointsHeld()}),0)>25)throw Error("You can only put cards carrying a maximum of 25 points down!");var t=this.getPlayerByName(e);if(!t)throw Error("This player does not exist!");a.forEach((function(e){if(!t.hasCard)throw Error("Cannot find card "+e.value+" "+e.color+" on player "+t.name+"!")})),a.forEach((function(e){t.removeCard(e)})),this._hiddenCards=a,this.emit("cardput",{player:e,cards:a}),this.phase="PLAYING",this.emit("phaseChange",{phase:this.phase});var r=this.getPlayerTeam(t).players.filter((function(a){return!(a.name===e)}))[0];this.initRound(r)},a.prototype.play=function(e){var a=this;if(this._currentRoundCards.length>3)throw Error("Players can only play once every round!");if(!this._currentPlayer.hasCard(e))throw Error("Current player "+this._currentPlayer.name+" does not have card "+e.toString()+" at hand!");if(this._currentRoundCards.length>0&&e.color!==this._currentRoundCards[0].card.color||e.isMaster(this.masterColor,this.masterNumber)&&this._currentRoundCards[0].card.isMaster(this.masterColor,this.masterNumber)){var t=void 0;if(this._currentRoundCards.length>0&&!this._currentRoundCards[0].card.isMaster(this.masterColor,this.masterNumber)?t=!!this._currentPlayer.hand.filter((function(e){if(!e.isMaster(a.masterColor,a.masterNumber))return e.color===a._currentRoundCards[0].card.color})):this._currentRoundCards.length>0&&this._currentRoundCards[0].card.isMaster(this.masterColor,this.masterNumber)&&(t=!!this._currentPlayer.hand.filter((function(e){return e.isMaster(a.masterColor,a.masterNumber)}))),this._currentRoundCards.length>0&&t)throw Error("You cannot play card "+e.toString()+" because you have other matching cards!")}this._currentRoundCards.push({card:e,playedBy:this._currentPlayer}),this._currentPlayer.removeCard(e),this.emit("cardplay",{player:this._currentPlayer.name,card:e}),4===this._currentRoundCards.length?this.cleanRound():this._currentPlayer=this.nextPlayer},a.prototype.initRound=function(e){this._currentPlayer=e,this.roundCount++},a.prototype.cleanRound=function(){var e=this;if(4!==this._currentRoundCards.length)throw Error("Not everyone has played a card yet!");this._currentRoundCards[0];var a=this._currentRoundCards.reduce((function(a,t){return t.card.isMaster(e.masterColor,e.masterNumber)&&!a.card.isMaster(e.masterColor,e.masterNumber)||t.card.color===a.card.color&&t.card.value>a.card.value?t:a})),t=this.getPlayerTeam(a.playedBy);if("ATTACK"===t.role){var r=this._currentRoundCards.map((function(e){if(e.card.isSpecial())return{card:e.card,points:e.card.pointsHeld()}}));t.ownedCards=t.ownedCards.concat(r)}var n=this._currentRoundCards.map((function(e){if(!e.card.isSpecial())return e}));if(this._discardedPile=this._discardedPile.concat(n),this.emit("roundend",{winner:t,cards:this._currentRoundCards}),this._currentRoundCards=[],this.roundCount++,12===this.roundCount){var c=void 0;c="ATTACK"===t.role?this.calculateScore(!0):this.calculateScore(!1),this.emit("end",{score:c})}else this.initRound(a.playedBy)},a.prototype.calculateScore=function(e){var a=0;e&&(a+=this._hiddenCards.reduce((function(e,a){return e+a.pointsHeld()}),0));return a+=this._teams.filter((function(e){return"ATTACK"===e.role}))[0].ownedCards.reduce((function(e,a){return e+a.points}),0)},a.prototype.getPlayerTeam=function(e){return"string"!==typeof e&&(e=e.name),this._teams.filter((function(a){return!(0===a.players.filter((function(a){return a.name===e})).length)}))[0]},a.prototype.getPlayerIndex=function(e){return"string"!==typeof e&&(e=e.name),this._players.findIndex((function(a){return a.name===e}))},a.prototype.getPlayerByName=function(e){var a=this._players[this.getPlayerIndex(e)];if(a)return a},a.prototype.findMostDuplicates=function(e){for(var a={},t=0;t<e.length;t++)a[e[t]]=a[e[t]]?a[e[t]]+1:1;return Object.keys(a).sort((function(e,t){return a[t]-a[e]}))[0]},Object.defineProperty(a.prototype,"discardedPile",{get:function(){return this._discardedPile},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentRoundCards",{get:function(){return this._currentRoundCards},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"players",{get:function(){return this._players},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"teams",{get:function(){return this._teams},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hiddenCards",{get:function(){return this._hiddenCards},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentPlayer",{get:function(){return this._currentPlayer},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"nextPlayer",{get:function(){var e=this.getPlayerIndex(this._currentPlayer);return 4===++e&&(e=0),this._players[e]},enumerable:!1,configurable:!0}),a}(n.EventEmitter);a.Game=i},84:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.Player=void 0;var r=function(){function e(e){this.hand=[],this.name=e}return e.prototype.hasCard=function(e){return!!this.hand.includes(e)},e.prototype.removeCard=function(e){if(this.hasCard(e)){var a=this.hand.findIndex((function(a){return a.value===e.value&&a.color===e.color}));this.hand.splice(a,1)}},e}();a.Player=r},85:function(e,a,t){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(a,"__esModule",{value:!0}),a.Deck=void 0;var n=t(20),c=r(t(86));var l=function(){function e(){this.shuffle=function(){for(var e=[],a=2;a<15;a++)for(var t=1;t<5;t++)e.push(new n.Card(a,t));return e.push(new n.Card(15),new n.Card(16)),c.default(e),e}()}return Object.defineProperty(e.prototype,"cards",{get:function(){return this.shuffle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"length",{get:function(){return this.shuffle.length},enumerable:!1,configurable:!0}),e.prototype.draw=function(){var e=this.cards[0];return this.shuffle.shift(),e},e.prototype.takeRemaining=function(){var e=this.cards;return this.shuffle=[],e},e}();a.Deck=l},87:function(e,a,t){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.Team=void 0;var r=function(){function e(e,a){var t=e[0],r=e[1];this._players=[t,r],this.role=a}return Object.defineProperty(e.prototype,"players",{get:function(){return this._players},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ownedCards",{get:function(){return this._ownedCards},set:function(e){this._ownedCards=e},enumerable:!1,configurable:!0}),e.prototype.addCard=function(e){var a={card:e,points:e.pointsHeld()};this._ownedCards.push(a)},e}();a.Team=r},88:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),c=t(39),l=t.n(c),s=(t(46),t(3)),o=(t(47),t(40)),i=t.n(o),m=t(1),u=t(4),d=t(2),p=t.n(d),E=(t(38),t(6));function h(e){var a=e.isOpen,t=e.discardedCards,r=e.takenCards,c=e.flip,l=e.score,s=e.hiddenCards;return n.a.createElement("div",{className:"result",style:{visibility:a?"visible":"hidden"}},n.a.createElement("div",{className:"title"},"This game has ended!"),n.a.createElement("div",{className:"summary"},n.a.createElement("p",null,"Total score of attacking team: ",l),n.a.createElement("p",null,"Hidden card flip: ",c?"true":"false"),n.a.createElement("p",null,"Number of discarded cards: ",t.length),n.a.createElement("p",null,"Number of taken cards: ",r.length)),n.a.createElement("div",{className:"cards-summary"},n.a.createElement("p",null,"Cards hidden:"),n.a.createElement("div",{className:"taken-cards-container"},s.map((function(e){return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-small"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])}))))})))),n.a.createElement("div",{className:"cards-summary"},n.a.createElement("p",null,"Cards successfully taken:"),n.a.createElement("div",{className:"taken-cards-container"},r.map((function(e){return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-small"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])}))),n.a.createElement("div",{className:"card-played-by"},n.a.createElement("div",null,e.points)))})))),n.a.createElement("div",{className:"exit"},n.a.createElement("button",{onClick:function(){return window.location.reload()}},"Restart game")))}var f=new E.a;function v(e){var a=e.game,t=e.name,c=Object(r.useContext)(P),l=Object(r.useState)(),o=Object(s.a)(l,2),i=o[0],d=o[1],E=Object(r.useState)([]),v=Object(s.a)(E,2),N=v[0],y=v[1],g=Object(r.useState)("NORMAL"),b=Object(s.a)(g,2),C=b[0],_=b[1],w=Object(r.useState)([]),O=Object(s.a)(w,2),k=O[0],A=O[1],T=Object(r.useState)([]),j=Object(s.a)(T,2),G=j[0],R=j[1],I=Object(r.useState)([]),L=Object(s.a)(I,2),M=L[0],V=L[1],K=Object(r.useState)(),S=Object(s.a)(K,2),B=S[0],F=S[1],D=Object(r.useState)(),H=Object(s.a)(D,2),x=H[0],Y=H[1],J=Object(r.useState)(),U=Object(s.a)(J,2),q=U[0],W=U[1],z=Object(r.useState)(),X=Object(s.a)(z,2),Q=X[0],$=X[1],Z=Object(r.useState)(),ee=Object(s.a)(Z,2),ae=ee[0],te=ee[1],re=Object(r.useState)([]),ne=Object(s.a)(re,2),ce=ne[0],le=ne[1],se=Object(r.useRef)(null),oe=function(e){le((function(a){return[].concat(Object(u.a)(a),[e])})),setTimeout((function(){se.current.scrollTop=se.current.scrollHeight+10}),0)};Object(r.useEffect)((function(){d(a),c.on("dispatch",(function(e){var a=e.game,t=e.type,r=e.payload;switch(d(a),t){case"cardDraw":oe("".concat(r.player.name," has drawn a card!"));break;case"cardTake":oe("".concat(r.player.name," has taken remaining cards!"));break;case"cardPut":oe("".concat(r.player.name," has put down six cards for the defending team!"));break;case"setMasterColor":oe("".concat(r.player.name," used their ").concat(m.Values[r.card._value]," ").concat(m.Colors[r.card._color]," card to set the master color!"));break;case"cardPlay":_("NORMAL"),V((function(e){return[].concat(Object(u.a)(e),[[r.card]])})),oe("".concat(r.player.name," has played card ").concat(m.Values[r.card.card._value]," ").concat(m.Colors[r.card.card._color],"!"));break;case"roundEnd":_("NORMAL"),V([]),A([]),oe("A round has ended with the ".concat(r.winner.role," team winning. ").concat(r.discardedCards.length," cards discarded and ").concat(r.takenCards.length," cards taken."));break;case"strongBomb":_("BOMB"),V((function(e){return[].concat(Object(u.a)(e),[r.cards])})),oe("".concat(r.player.name," has played a strong bomb!"));break;case"weakBomb":_("BOMB"),V((function(e){return[].concat(Object(u.a)(e),[r.cards])})),oe("".concat(r.player.name," has played a weak bomb!"));break;case"multipleCardPlay":_("MULTIPLE"),V((function(e){return[].concat(Object(u.a)(e),[r.cards])})),oe("".concat(r.player.name," has played multiple cards!"));break;case"forMultipleCardPlay":V((function(e){return[].concat(Object(u.a)(e),[r.cards])})),oe("".concat(r.player.name," has played multiple cards!"));break;case"forBombCardPlay":V((function(e){return[].concat(Object(u.a)(e),[r.cards])})),oe("".concat(r.player.name," has played in response to a bomb!"));break;case"requestChallenge":F(r.cards),_("CHALLENGE"),oe("".concat(r.player.name," is trying to play multiple cards!"));break;case"challengeFailed":oe("".concat(r.playerName," is not challenging!"));break;case"challengeSuccess":oe("".concat(r.playerName," has successfully challenged!"));break;case"gameEnd":f.remove("name"),f.remove("room"),oe("The game has ended with the attacking team holding ".concat(r.score," score and ").concat(r.flipCards?"flipping the hidden cards":"failing to flip the final cards","!")),te({flip:r.flipCards,isOpen:!0,score:r.score,discardedCards:a._discardedPile,takenCards:a._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards,hiddenCards:a._hiddenCards});break;case"drawPhase":oe("Draw phase now");break;case"takePhase":oe("Take phase now");break;case"putPhase":oe("Put phase now");break;case"playPhase":oe("Play phase now");break;case"playerLeave":oe("".concat(r.name," has left the game!"));break;case"playerJoin":oe("".concat(r.name," has joined back!"));break;case"error":oe("Error! ".concat(r.message))}console.log({gameInstance:a,type:t,payload:r})}))}),[]),Object(r.useEffect)((function(){console.log({game:i,player:x,teammate:q,opponents:Q}),i&&function(){var e=i._players.filter((function(e){return e.name===t}))[0],a=i._players.filter((function(a){return!(a.name===t)&&a.role===e.role}))[0],r=i._players.filter((function(a){return!(a.role===e.role)}));i._players.findIndex((function(e){return e.name===t}))<2&&r.reverse();for(var n=i._currentRoundCards.length/i.currentRoundCount,c=function(e){V((function(a){return[].concat(Object(u.a)(a),[i._currentRoundCards.slice(e,e+n)])}))},l=0;l<i._currentRoundCards.length;l+=n)c(l);R(i._currentRoundTopCards),C||_(n>1?"MULTIPLE":"NORMAL"),Y(e),W(a),$(r)}()}),[i]);var ie=function(e){if(N.find((function(a){return a._color===e._color&&a._value===e._value}))){var a=Object(u.a)(N),t=a.findIndex((function(a){return a._color===e._color&&a._value===e._value}));a.splice(t,1),y(a)}else y((function(a){return[].concat(Object(u.a)(a),[e])}))},me=function(e){if(k.find((function(a){return a._color===e._color&&a._value===e._value}))){var a=Object(u.a)(k),t=a.findIndex((function(a){return a._color===e._color&&a._value===e._value}));a.splice(t,1),A(a)}else A((function(a){return[].concat(Object(u.a)(a),[e])}))},ue=function(){k.length>1?oe("can only play 1 card"):0===k.length?oe("pick a card"):c.emit("requestPlay",{card:k[0]})};return i&&x&&q&&Q?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"side-bar"},n.a.createElement("div",null,"Playing as: ",x.name),n.a.createElement("div",null,"Master number: ",m.Values[i.masterNumber]||"JOKER"),n.a.createElement("div",null,"Master color: ",m.Colors[i.masterColor]||"Not yet selected"),n.a.createElement("div",null,"Current phase: ",i.phase),n.a.createElement("div",null,"You are on the ",x.role,"ING team!"),n.a.createElement("div",null,"PUTTING"===i.phase&&18===x.hand.length&&"Cards you are putting down:",n.a.createElement("div",{className:"selected-cards"},"PUTTING"===i.phase&&18===x.hand.length&&N.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-active-small",onClick:function(){return ie(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))})),"PLAYING"===i.phase&&(i._currentPlayer.name===x.name||"CHALLENGE"===C)&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,"Currently selected cards:"),k.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-active-small",onClick:function(){return me(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))))),n.a.createElement("div",{className:"leave-game"},n.a.createElement("button",{onClick:function(){window.confirm("Are you sure you want to leave this game?")&&(f.remove("room"),f.remove("game"),window.location.reload())}},"Leave this game"))),n.a.createElement("div",{className:"game-container"},n.a.createElement("div",{className:"teammate"},n.a.createElement("div",{className:"other-player-name"},q.name),n.a.createElement("div",{className:"other-hand-container"},q.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{key:a,className:"card-wrapper-small"},n.a.createElement("img",{className:"BACK",src:p.a})))}))),n.a.createElement("div",{className:"other-role"},q.role,"ING")),n.a.createElement(n.a.Fragment,null,Q.map((function(e,a){return n.a.createElement("div",{key:a,className:"opponent-".concat(a)},n.a.createElement("div",{className:"other-player-name"},e.name),n.a.createElement("div",{className:"other-hand-container"},e.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{key:a,className:"card-wrapper-small"},n.a.createElement("img",{className:"BACK",src:p.a})))}))),n.a.createElement("div",{className:"other-role"},e.role,"ING"))}))),n.a.createElement("div",{className:"self"},n.a.createElement("div",{className:"button-2"},n.a.createElement("div",null,"DRAWING"===i.phase&&i._currentPlayer.name===x.name&&n.a.createElement("button",{className:"button-2",onClick:function(){c.emit("requestDraw")}},"Draw")),n.a.createElement("div",null,"TAKING"===i.phase&&"DEFEND"===x.role&&n.a.createElement("button",{className:"button-2",onClick:function(){c.emit("requestTake",{player:x})}},"Take remaining")),n.a.createElement("div",null,"PUTTING"===i.phase&&18===x.hand.length&&n.a.createElement("button",{className:"button-2",onClick:function(){6!==N.length?oe("You have ".concat(N.length,"/6 cards in your queue!")):c.emit("requestPut",{player:x,cards:N})}},"Put down selected"))),n.a.createElement("div",{className:"hand-container"},n.a.createElement(n.a.Fragment,null,"DRAWING"===i.phase&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper-active",onClick:function(){return function(e){e._value!==i.masterNumber||e._color===m.Colors.JOKER?oe("Your card ".concat(e._color," ").concat(e._value," cannot be used to set the master color!")):c.emit("requestSetMasterColor",{card:e,player:x})}(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"TAKING"===i.phase&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PUTTING"===i.phase&&18===x.hand.length&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper-active",onClick:function(){return ie(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PUTTING"===i.phase&&!(18===x.hand.length)&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PLAYING"===i.phase&&(i._currentPlayer.name===x.name||"CHALLENGE"===C)&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper-active",onClick:function(){return me(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PLAYING"===i.phase&&!(i._currentPlayer.name===x.name)&&!("CHALLENGE"===C)&&x.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))})))),n.a.createElement("div",null,"CHALLENGE"===C&&!(i._currentPlayer.name===x.name)&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"challenge-desc"},i._currentPlayer.name," is playing multiple cards. Challenge?"),n.a.createElement("button",{className:"button-2",onClick:function(){1!==k.length?oe("can only challenge with 1 card"):(c.emit("challenge",{card:k[0],player:x}),_("NORMAL"),_("NONE"))}},"Challenge"),n.a.createElement("button",{className:"button-3",onClick:function(){return c.emit("noChallenge",{playerName:x.name}),void _("NORMAL")}},"Pass")),"PLAYING"===i.phase&&"NONE"!==C&&i._currentPlayer.name===x.name&&"NORMAL"===C&&0===i.currentRoundCount&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-1",onClick:function(){return ue()}},"Play"),n.a.createElement("button",{className:"button-2",onClick:function(){k.length<2?oe("play 1 card plz"):c.emit("requestPlayMultiple",{cards:k})}},"Play many"),n.a.createElement("button",{className:"button-3",onClick:function(){4!==k.length?oe("you can only throw bombs with 4 cards!"):k.find((function(e){return!(e._value===k[0]._value)}))?oe("you can only throw bombs with cards of same value"):c.emit("requestPlayBomb",{cards:k})}},"Play bomb")),"PLAYING"===i.phase&&i._currentPlayer.name===x.name&&"NORMAL"===C&&i.currentRoundCount>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-1",onClick:function(){return ue()}},"Play")),"PLAYING"===i.phase&&i._currentPlayer.name===x.name&&"BOMB"===C&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-3",onClick:function(){4!==k.length?oe("you must play 4 cards!"):c.emit("requestPlayForBomb",{cards:k})}},"Play")),"PLAYING"===i.phase&&i._currentPlayer.name===x.name&&"MULTIPLE"===C&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-2",onClick:function(){k.length!==G.length?oe("expected ".concat(G.length," cards, got ").concat(k.length," instead.")):c.emit("requestPlayForMultiple",{cards:k})}},"Play")))),n.a.createElement("div",{className:"game-info-container"},n.a.createElement("div",{className:"hidden-cards-reveal"},"PUTTING"===i.phase&&i._hiddenCards.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])})))}))),n.a.createElement("div",{className:"hidden-cards-reveal"},"CHALLENGE"===C&&n.a.createElement("div",{className:"title"},"\u7529\u724c"),"CHALLENGE"===C&&B&&B.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])})))}))),n.a.createElement("div",{className:"draw-pile"},("DRAWING"===i.phase||"TAKING"===i.phase)&&i.drawPile.shuffle.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium",style:{position:"absolute",zIndex:-1*a,top:"0",left:"0",transform:"translateY(".concat(.4*a,"px) rotateX(80deg)")}},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"BACK"})))}))),n.a.createElement("div",{className:"current-cards"},n.a.createElement("div",{className:"teammate-card"},M.find((function(e){return e[0].playedBy.name===q.name}))&&M.find((function(e){return e[0].playedBy.name===q.name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"op-1-card"},M.find((function(e){return e[0].playedBy.name===Q[0].name}))&&M.find((function(e){return e[0].playedBy.name===Q[0].name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"op-2-card"},M.find((function(e){return e[0].playedBy.name===Q[1].name}))&&M.find((function(e){return e[0].playedBy.name===Q[1].name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"self-card"},M.find((function(e){return e[0].playedBy.name===x.name}))&&M.find((function(e){return e[0].playedBy.name===x.name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))})))),"PLAYING"===i.phase&&n.a.createElement("div",{className:"taken-cards"},0!==i._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards.length&&n.a.createElement("div",{className:"description"},"Cards taken"),i._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-small"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),"PLAYING"===i.phase&&n.a.createElement("div",{className:"discarded-cards"},0!==i._discardedPile.length&&n.a.createElement("div",{className:"description"},"Cards discarded"),i._discardedPile.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium",style:{position:"absolute",zIndex:-1*a,top:"0",left:"0",transform:"translateY(".concat(.4*a,"px) rotateX(80deg)")}},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"BACK"})))}))))),n.a.createElement("div",{ref:se,className:"console"},ce.map((function(e,a){return n.a.createElement("div",{key:a,className:"console-message"},e)}))),ae&&n.a.createElement(h,{isOpen:ae.isOpen,discardedCards:ae.discardedCards,takenCards:ae.takenCards,score:ae.score,flip:ae.flip,hiddenCards:ae.hiddenCards})):n.a.createElement("div",null,"Loading...")}function N(e){var a=e.isOpen,t=e.discardedCards,r=e.takenCards,c=e.flip,l=e.score,s=e.hiddenCards;return n.a.createElement("div",{className:"result",style:{visibility:a?"visible":"hidden"}},n.a.createElement("div",{className:"title"},"\u9019\u5834\u904a\u6232\u7d50\u675f\u4e86\uff01"),n.a.createElement("div",{className:"summary"},n.a.createElement("p",null,"\u6399\u5206\u65b9\u5f97\u5206\uff1a",l),n.a.createElement("p",null,"\u6399\u5206\u65b9\u7ffb\u5e95\u724c\uff1a",c?"\u6210\u529f":"\u5931\u6557"),n.a.createElement("p",null,"\u68c4\u724c\u6578\u91cf\uff1a",t.length),n.a.createElement("p",null,"\u6399\u5206\u65b9\u5f97\u724c\u6578\u91cf\uff1a",r.length)),n.a.createElement("div",{className:"cards-summary"},n.a.createElement("p",null,"\u5e95\u724c\uff1a"),n.a.createElement("div",{className:"taken-cards-container"},s.map((function(e){return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-small"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])}))))})))),n.a.createElement("div",{className:"cards-summary"},n.a.createElement("p",null,"\u6399\u5206\u65b9\u5f97\u724c\uff1a"),n.a.createElement("div",{className:"taken-cards-container"},r.map((function(e){return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-small"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])}))),n.a.createElement("div",{className:"card-played-by"},n.a.createElement("div",null,e.points)))})))),n.a.createElement("div",{className:"exit"},n.a.createElement("button",{onClick:function(){return window.location.reload()}},"\u91cd\u65b0\u958b\u59cb")))}var y,g=new E.a,b=function(e){switch(e){case 2:return"2";case 3:return"3";case 4:return"4";case 5:return"5";case 6:return"6";case 7:return"7";case 8:return"8";case 9:return"9";case 10:return"10";case 11:return"J";case 12:return"Q";case 13:return"K";case 14:return"A";case 15:return"\u5c0f\u8c93";case 16:return"\u5927\u8c93"}};function C(e){e.game;var a=e.name,t=Object(r.useContext)(P),c=Object(r.useState)(),l=Object(s.a)(c,2),o=l[0],i=l[1],d=Object(r.useState)([]),E=Object(s.a)(d,2),h=E[0],f=E[1],v=Object(r.useState)("NORMAL"),C=Object(s.a)(v,2),_=C[0],w=C[1],O=Object(r.useState)([]),k=Object(s.a)(O,2),A=k[0],T=k[1],j=Object(r.useState)([]),G=Object(s.a)(j,2),R=G[0],I=G[1],L=Object(r.useState)([]),M=Object(s.a)(L,2),V=M[0],K=M[1],S=Object(r.useState)(),B=Object(s.a)(S,2),F=B[0],D=B[1],H=Object(r.useState)(),x=Object(s.a)(H,2),Y=x[0],J=x[1],U=Object(r.useState)(),q=Object(s.a)(U,2),W=q[0],z=q[1],X=Object(r.useState)(),Q=Object(s.a)(X,2),$=Q[0],Z=Q[1],ee=Object(r.useState)([]),ae=Object(s.a)(ee,2),te=ae[0],re=ae[1],ne=Object(r.useState)(),ce=Object(s.a)(ne,2),le=ce[0],se=ce[1],oe=Object(r.useRef)(null),ie=function(e){re((function(a){return[].concat(Object(u.a)(a),[e])})),setTimeout((function(){oe.current.scrollTop=oe.current.scrollHeight+10}),0)};Object(r.useEffect)((function(){t.on("dispatch",(function(e){var a=e.game,t=e.type,r=e.payload;switch(i(a),t){case"cardDraw":ie("".concat(r.player.name,"\u6478\u8d70\u4e86\u4e00\u5f35\u724c"));break;case"cardTake":ie("".concat(r.player.name,"\u6536\u8d70\u4e86\u5e95\u724c"));break;case"cardPut":ie("".concat(r.player.name,"\u6263\u4e0b\u4e86\u516d\u5f35\u5e95\u724c"));break;case"setMasterColor":ie("".concat(r.player.name,"\u7528").concat(y[r.card._color]).concat(b(r.card._value),"\u4f86\u6c7a\u5b9a\u4e86\u4e3b\u8272\uff01"));break;case"cardPlay":w("NORMAL"),K((function(e){return[].concat(Object(u.a)(e),[[r.card]])})),ie("".concat(r.player.name,"\u6253\u51fa\u4e86").concat(y[r.card.card._color]).concat(b(r.card.card._value),"!"));break;case"roundEnd":w("NORMAL"),K([]),T([]),ie("".concat("ATTACK"===r.winner.role?"\u6399\u5206":"\u6253\u5206","\u65b9\u8d0f\u5f97\u4e86\u9019\u4e00\u8f2a\u3002 ").concat(r.discardedCards.length,"\u5f35\u724c\u88ab\u68c4\u6389").concat(0===r.takenCards.length?"\u3002":"\uff0c".concat(r.takenCards.length,"\u5f35\u724c\u88ab\u6399\u5206\u65b9\u6536\u8d70\u3002")));break;case"strongBomb":w("BOMB"),K((function(e){return[].concat(Object(u.a)(e),[r.cards])})),ie("".concat(r.player.name,"\u7529\u4e86\u6c92\u6709\u5e95\u724c\u7684\u56db\u5f35\u5361"));break;case"weakBomb":w("BOMB"),K((function(e){return[].concat(Object(u.a)(e),[r.cards])})),ie("".concat(r.player.name,"\u7529\u4e86\u6709\u5e95\u724c\u7684\u56db\u5f35\u5361"));break;case"multipleCardPlay":w("MULTIPLE"),K((function(e){return[].concat(Object(u.a)(e),[r.cards])})),ie("".concat(r.player.name,"\u4e00\u6b21\u6253\u51fa\u4e86\u591a\u5f35\u724c"));break;case"forMultipleCardPlay":K((function(e){return[].concat(Object(u.a)(e),[r.cards])})),ie("".concat(r.player.name,"\u4e00\u6b21\u6027\u6253\u51fa\u4e86\u591a\u5f35\u724c"));break;case"forBombCardPlay":K((function(e){return[].concat(Object(u.a)(e),[r.cards])})),ie("".concat(r.player.name,"\u6253\u51fa\u4e86\u56db\u5f35\u724c"));break;case"requestChallenge":w("CHALLENGE"),D(r.cards),ie("".concat(r.player.name,"\u60f3\u4e00\u6b21\u6253\u51fa\u591a\u5f35\u724c\u3002\u60a8\u8981\u6311\u6230\u55ce\uff1f"));break;case"challengeFailed":ie("".concat(r.playerName,"\u9078\u64c7\u4e0d\u6311\u6230"));break;case"challengeSuccess":ie("".concat(r.playerName,"\u6210\u529f\u7684\u6311\u6230\u4e86"));break;case"gameEnd":g.remove("name"),g.remove("room"),ie("\u672c\u5834\u904a\u6232\u7d50\u675f\u4e86\uff01\u6253\u7684\u4e00\u65b9\u7e3d\u5171\u62ff\u5230\u4e86".concat(r.score,"\u5206\uff0c").concat(r.flipCards?"\u4e26\u4e14\u6210\u529f\u7684\u7ffb\u4e86\u5e95\u724c":"\u4f46\u6c92\u80fd\u5920\u7ffb\u5230\u5e95\u724c")),se({flip:r.flipCards,isOpen:!0,score:r.score,discardedCards:a._discardedPile,takenCards:a._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards,hiddenCards:a._hiddenCards});break;case"drawPhase":ie("\u958b\u59cb\u6478\u724c\u4e86");break;case"takePhase":ie("\u6253\u5206\u7684\u4e00\u968a\u53ef\u4ee5\u62ff\u8d70\u5e95\u724c\u4e86");break;case"putPhase":ie("\u6253\u5206\u7684\u4e00\u968a\u53ef\u4ee5\u958b\u59cb\u6263\u5e95\u724c\u4e86");break;case"playPhase":ie("\u958b\u59cb\u51fa\u724c\u4e86\uff01");break;case"playerLeave":ie("".concat(r.name,"\u525b\u525b\u96e2\u958b\u4e86\u904a\u6232"));break;case"playerJoin":ie("".concat(r.name,"\u525b\u525b\u56de\u5230\u4e86\u904a\u6232"));break;case"error":ie("\u932f\u8aa4\uff01".concat(r.message))}console.log({gameInstance:a,type:t,payload:r})}))}),[]),Object(r.useEffect)((function(){o&&function(){var e=o._players.filter((function(e){return e.name===a}))[0],t=o._players.filter((function(t){return!(t.name===a)&&t.role===e.role}))[0],r=o._players.filter((function(a){return!(a.role===e.role)}));o._players.findIndex((function(e){return e.name===a}))<2&&r.reverse();for(var n=o._currentRoundCards.length/o.currentRoundCount,c=function(e){K((function(a){return[].concat(Object(u.a)(a),[o._currentRoundCards.slice(e,e+n)])}))},l=0;l<o._currentRoundCards.length;l+=n)c(l);I(o._currentRoundTopCards),_||w(n>1?"MULTIPLE":"NORMAL"),J(e),z(t),Z(r)}()}),[o]);var me=function(e){if(h.find((function(a){return a._color===e._color&&a._value===e._value}))){var a=Object(u.a)(h),t=a.findIndex((function(a){return a._color===e._color&&a._value===e._value}));a.splice(t,1),f(a)}else f((function(a){return[].concat(Object(u.a)(a),[e])}))},ue=function(e){if(A.find((function(a){return a._color===e._color&&a._value===e._value}))){var a=Object(u.a)(A),t=a.findIndex((function(a){return a._color===e._color&&a._value===e._value}));a.splice(t,1),T(a)}else T((function(a){return[].concat(Object(u.a)(a),[e])}))},de=function(){A.length>1?ie("\u60a8\u4e00\u6b21\u53ea\u80fd\u51fa\u4e00\u5f35\u724c\uff01"):0===A.length?ie("\u8acb\u9078\u64c7\u4e00\u5f35\u60a8\u60f3\u51fa\u7684\u724c\uff01"):t.emit("requestPlay",{card:A[0]})};return o&&Y&&W&&$?n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"side-bar"},n.a.createElement("div",null,"\u59d3\u540d\uff1a",Y.name),n.a.createElement("div",null,"\u4e3b\u6578\uff1a",b(o.masterNumber)||"\u8c93"),n.a.createElement("div",null,"\u4e3b\u82b1\u8272\uff1a",y[o.masterColor]||"\u5f85\u5b9a"),n.a.createElement("div",null,"\u904a\u6232\u968e\u6bb5\uff1a","DRAWING"===o.phase?"\u6478\u724c":"TAKING"===o.phase?"\u62ff\u5e95":"PUTTING"===o.phase?"\u6263\u5e95":"\u51fa\u724c"),n.a.createElement("div",null,"\u60a8\u5728","ATTACK"===Y.role?"\u6399\u5206":"\u6253\u5206","\u968a"),n.a.createElement("div",null,"PUTTING"===o.phase&&18===Y.hand.length&&"\u6e96\u5099\u4f7f\u7528\u7684\u724c\uff1a",n.a.createElement("div",{className:"selected-cards"},"PUTTING"===o.phase&&18===Y.hand.length&&h.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-active-small",onClick:function(){return me(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))})),"PLAYING"===o.phase&&(o._currentPlayer.name===Y.name||"CHALLENGE"===_)&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,"\u60a8\u9078\u64c7\u7684\u724c\uff1a"),A.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{className:"card-wrapper-active-small",onClick:function(){return ue(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))})))))),n.a.createElement("div",{className:"leave-game"},n.a.createElement("button",{onClick:function(){window.confirm("\u60a8\u78ba\u8a8d\u8981\u96e2\u958b\u9019\u4e00\u904a\u6232\u55ce\uff1f")&&(g.remove("room"),g.remove("game"),window.location.reload())}},"\u96e2\u958b\u904a\u6232")),n.a.createElement("div",{className:"game-container"},n.a.createElement("div",{className:"teammate"},n.a.createElement("div",{className:"other-player-name"},W.name),n.a.createElement("div",{className:"other-hand-container"},W.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{key:a,className:"card-wrapper-small"},n.a.createElement("img",{className:"BACK",src:p.a})))}))),n.a.createElement("div",{className:"other-role"},"ATTACK"===W.role?"\u6399\u5206":"\u6253\u5206")),n.a.createElement(n.a.Fragment,null,$.map((function(e,a){return n.a.createElement("div",{key:a,className:"opponent-".concat(a)},n.a.createElement("div",{className:"other-player-name"},e.name),n.a.createElement("div",{className:"other-hand-container"},e.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-small"},n.a.createElement("div",{key:a,className:"card-wrapper-small"},n.a.createElement("img",{className:"BACK",src:p.a})))}))),n.a.createElement("div",{className:"other-role"},"ATTACK"===e.role?"\u6399\u5206":"\u6253\u5206"))}))),n.a.createElement("div",{className:"self"},n.a.createElement("div",{className:"button-2"},n.a.createElement("div",null,"DRAWING"===o.phase&&o._currentPlayer.name===Y.name&&n.a.createElement("button",{className:"button-2",onClick:function(){t.emit("requestDraw")}},"\u6478\u724c")),n.a.createElement("div",null,"TAKING"===o.phase&&"DEFEND"===Y.role&&n.a.createElement("button",{className:"button-2",onClick:function(){t.emit("requestTake",{player:Y})}},"\u62ff\u5e95\u724c")),n.a.createElement("div",null,"PUTTING"===o.phase&&18===Y.hand.length&&n.a.createElement("button",{className:"button-2",onClick:function(){6!==h.length?ie("\u60a8\u6e96\u5099\u653e\u7f6e\u7684\u5361\u724c\u73fe\u5728\u6709".concat(h.length,"/6\u5f35\uff01")):t.emit("requestPut",{player:Y,cards:h})}},"\u6263\u5e95"))),n.a.createElement("div",{className:"hand-container"},n.a.createElement(n.a.Fragment,null,"DRAWING"===o.phase&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper-active",onClick:function(){return function(e){e._value!==o.masterNumber||e._color===m.Colors.JOKER?ie("\u60a8\u7684\u5361\u724c ".concat(y[e._color]).concat(b(e._value)," \u4e0d\u80fd\u7528\u4f86\u8a2d\u7f6e\u4e3b\u8272\uff01")):t.emit("requestSetMasterColor",{card:e,player:Y})}(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"TAKING"===o.phase&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PUTTING"===o.phase&&18===Y.hand.length&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{key:a,className:"card-wrapper-active",onClick:function(){return me(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PUTTING"===o.phase&&!(18===Y.hand.length)&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PLAYING"===o.phase&&(o._currentPlayer.name===Y.name||"CHALLENGE"===_)&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper-active",onClick:function(){return ue(e)}},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))}))),n.a.createElement(n.a.Fragment,null,"PLAYING"===o.phase&&!(o._currentPlayer.name===Y.name)&&!("CHALLENGE"===_)&&Y.hand.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value]),src:p.a})))})))),n.a.createElement("div",null,"CHALLENGE"===_&&!(o._currentPlayer.name===Y.name)&&n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"challenge-desc"},o._currentPlayer.name,"\u60f3\u4e00\u6b21\u6253\u51fa\u591a\u5f35\u724c\u3002\u60a8\u60f3\u6311\u6230\u55ce\uff1f"),n.a.createElement("button",{className:"button-2",onClick:function(){1!==A.length?ie("\u60a8\u53ea\u80fd\u7528\u4e00\u5f35\u724c\u4f86\u6311\u6230\uff01"):(t.emit("challenge",{card:A[0],player:Y}),w("NONE"))}},"\u6311\u6230"),n.a.createElement("button",{className:"button-3",onClick:function(){return t.emit("noChallenge",{playerName:Y.name}),void w("NORMAL")}},"\u4e0d\u6311\u6230")),"PLAYING"===o.phase&&"NONE"!==_&&o._currentPlayer.name===Y.name&&"NORMAL"===_&&0===o.currentRoundCount&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-1",onClick:function(){return de()}},"\u51fa\u724c"),n.a.createElement("button",{className:"button-2",onClick:function(){A.length<2?ie("\u8acb\u4f7f\u7528\u4e00\u6b21\u51fa\u4e00\u5f35\u724c\u7684\u9078\u9805\uff01"):t.emit("requestPlayMultiple",{cards:A})}},"\u51fa\u591a\u5f35\u724c"),n.a.createElement("button",{className:"button-3",onClick:function(){4!==A.length?ie("\u60a8\u5fc5\u9808\u4e00\u6b21\u6027\u7684\u75294\u5f35\u724c\uff01"):A.find((function(e){return!(e._value===A[0]._value)}))?ie("\u60a8\u53ea\u80fd\u7529\u540c\u6a23\u5927\u5c0f\u76844\u5f35\u724c\uff01"):t.emit("requestPlayBomb",{cards:A})}},"\u7529\u724c")),"PLAYING"===o.phase&&o._currentPlayer.name===Y.name&&"NORMAL"===_&&o.currentRoundCount>0&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-1",onClick:function(){return de()}},"\u51fa\u724c")),"PLAYING"===o.phase&&o._currentPlayer.name===Y.name&&"BOMB"===_&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-3",onClick:function(){4!==A.length?ie("\u60a8\u5fc5\u9808\u51fa4\u5f35\u724c\uff01"):t.emit("requestPlayForBomb",{cards:A})}},"\u7529\u724c")),"PLAYING"===o.phase&&o._currentPlayer.name===Y.name&&"MULTIPLE"===_&&n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button-2",onClick:function(){A.length!==R.length?ie("\u60a8\u9700\u8981\u51fa".concat(R.length,"\u5f35\u724c\uff0c\u4f46\u60a8\u73fe\u5728\u53ea\u9078\u64c7\u4e86").concat(A.length,"\u5f35\u724c\uff01")):t.emit("requestPlayForMultiple",{cards:A})}},"\u51fa\u591a\u5f35\u724c")))),n.a.createElement("div",{className:"game-info-container"},n.a.createElement("div",{className:"hidden-cards-reveal"},"PUTTING"===o.phase&&n.a.createElement("div",{className:"title"},"\u5e95\u724c"),"PUTTING"===o.phase&&o._hiddenCards.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])})))}))),n.a.createElement("div",{className:"hidden-cards-reveal"},"CHALLENGE"===_&&n.a.createElement("div",{className:"title"},"\u7529\u724c"),"CHALLENGE"===_&&F&&F.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper"},n.a.createElement("div",{className:"card-wrapper"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e._color],"-").concat(m.Values[e._value])})))}))),n.a.createElement("div",{className:"draw-pile"},o.drawPile&&o.drawPile.shuffle.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium",style:{position:"absolute",zIndex:-1*a,top:"0",left:"0",transform:"translateY(".concat(.4*a,"px) rotateX(80deg)")}},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"BACK"})))}))),n.a.createElement("div",{className:"current-cards"},n.a.createElement("div",{className:"teammate-card"},V.find((function(e){return e[0].playedBy.name===W.name}))&&V.find((function(e){return e[0].playedBy.name===W.name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"op-1-card"},V.find((function(e){return e[0].playedBy.name===$[0].name}))&&V.find((function(e){return e[0].playedBy.name===$[0].name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"op-2-card"},V.find((function(e){return e[0].playedBy.name===$[1].name}))&&V.find((function(e){return e[0].playedBy.name===$[1].name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),n.a.createElement("div",{className:"self-card"},V.find((function(e){return e[0].playedBy.name===Y.name}))&&V.find((function(e){return e[0].playedBy.name===Y.name})).map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))})))),"PLAYING"===o.phase&&n.a.createElement("div",{className:"taken-cards"},0!==o._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards.length&&n.a.createElement("div",{className:"description"},"Cards taken"),o._teams.find((function(e){return"ATTACK"===e.role}))._ownedCards.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium"},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"".concat(m.Colors[e.card._color],"-").concat(m.Values[e.card._value])})))}))),"PLAYING"===o.phase&&n.a.createElement("div",{className:"discarded-cards"},0!==o._discardedPile.length&&n.a.createElement("div",{className:"description"},"Cards discarded"),o._discardedPile.map((function(e,a){return n.a.createElement("div",{key:a,className:"outer-wrapper-medium",style:{position:"absolute",zIndex:-1*a,top:"0",left:"0",transform:"translateY(".concat(.4*a,"px) rotateX(80deg)")}},n.a.createElement("div",{className:"card-wrapper-medium"},n.a.createElement("img",{src:p.a,className:"BACK"})))}))))),n.a.createElement("div",{ref:oe,className:"console"},te.map((function(e,a){return n.a.createElement("div",{key:a,className:"console-message"},e)}))),le&&n.a.createElement(N,{isOpen:le.isOpen,discardedCards:le.discardedCards,takenCards:le.takenCards,score:le.score,flip:le.flip,hiddenCards:le.hiddenCards})):n.a.createElement("div",null,"\u52a0\u8f09\u4e2d...")}!function(e){e[e["\u7d05\u6843"]=1]="\u7d05\u6843",e[e["\u9ed1\u6843"]=2]="\u9ed1\u6843",e[e["\u6885\u82b1"]=3]="\u6885\u82b1",e[e["\u65b9\u584a"]=4]="\u65b9\u584a",e[e["\u8c93"]=5]="\u8c93"}(y||(y={}));var _=new E.a;function w(){var e=Object(r.useContext)(P),a=Object(r.useState)(),t=Object(s.a)(a,2),c=t[0],l=t[1],o=Object(r.useState)("ATTACK"),i=Object(s.a)(o,2),u=i[0],d=i[1],p=Object(r.useState)(),E=Object(s.a)(p,2),h=E[0],f=E[1],N=Object(r.useState)(_.get("lang")||"ENG"),y=Object(s.a)(N,2),g=y[0],b=y[1],w=Object(r.useState)("2"),O=Object(s.a)(w,2),k=O[0],A=O[1],T=Object(r.useState)(!1),j=Object(s.a)(T,2),G=j[0],R=j[1],I=Object(r.useState)(!1),L=Object(s.a)(I,2),M=L[0],V=L[1],K=Object(r.useState)(!1),S=Object(s.a)(K,2),B=S[0],F=S[1],D=Object(r.useRef)(null),H=Object(r.useRef)("ENG"),x=Object(r.useRef)(),Y=Object(r.useRef)();Object(r.useEffect)((function(){e.on("gameStart",(function(e){var a=e.game;_.set("name",x.current),_.set("room",Y.current),_.set("lang",H.current),R(a)})),e.on("roomJoin",(function(e){V(e)})),e.on("roomUpdate",(function(e){V(e)})),e.on("oops",(function(e){if(D.current)switch(e){case"DUPE_NAME":D.current.innerHTML="ENG"===H.current?"Someone in this room already has your name!":"\u60a8\u7684\u59d3\u540d\u5728\u8a72\u623f\u9593\u5167\u51fa\u73fe\u4e86\u91cd\u8907\uff01";break;case"FULL":D.current.innerHTML="ENG"===H.current?"This room is full!":"\u8a72\u623f\u9593\u5df2\u7d93\u4eba\u6eff\u4e86\uff01";break;case"IN_GAME":D.current.innerHTML="ENG"===H.current?"This room is already in-game!":"\u8a72\u623f\u9593\u5df2\u7d93\u958b\u59cb\u904a\u6232\u4e86\uff01";break;case"DUPE_ROLE":D.current.innerHTML="ENG"===H.current?"There are already two players taking your role!":"\u8a72\u623f\u9593\u5df2\u7d93\u6709\u5169\u4f4d\u76f8\u540c\u89d2\u8272\u7684\u73a9\u5bb6\u4e86\uff01"}}))}),[]);return G?"ENG"===g?n.a.createElement(v,{game:G,name:c}):n.a.createElement(C,{game:G,name:c}):M?n.a.createElement("div",{className:"home-container"},n.a.createElement("div",{className:"select-lang"},n.a.createElement("select",{name:"language",defaultValue:g,onChange:function(e){b(e.target.value),H.current=e.target.value,_.set("lang",e.target.value)}},n.a.createElement("option",{value:"ENG"},"English"),n.a.createElement("option",{value:"CHN"},"\u4e2d\u6587"))),n.a.createElement("div",{className:"room-name"},"ENG"===g?"You are in room ".concat("boolean"!=typeof M&&M.name):"\u60a8\u6b63\u5728\u623f\u9593".concat("boolean"!=typeof M&&M.name,"\u88e1")),n.a.createElement("div",{className:"room-info"}),n.a.createElement("div",{className:"room-players"},"boolean"!=typeof M&&M.players.map((function(e){if(e.name===c)return n.a.createElement("div",{key:"1",className:"room-player"},n.a.createElement("div",{className:"name"},n.a.createElement("label",null,"ENG"===g?"Name":"\u59d3\u540d"),n.a.createElement("div",{className:"inner"},"".concat(e.name,"ENG"===g?" (You)":"\uff08\u60a8\uff09"))),n.a.createElement("div",{className:"role"},n.a.createElement("label",null,"ENG"===g?"Role":"\u968a\u4f0d"),n.a.createElement("div",{className:"inner"},"ATTACK"===e.role?"ENG"===g?"ATTACK":"\u6399\u5206":"ENG"===g?"DEFEND":"\u6253\u5206")),n.a.createElement("div",{className:e.isReady?"ready":"not-ready"},n.a.createElement("label",null,"ENG"===g?"Status":"\u72c0\u614b"),n.a.createElement("div",{className:"inner"},e.isReady?"ENG"===g?"Ready":"\u5df2\u6e96\u5099\u597d":"ENG"===g?"Not ready":"\u672a\u6e96\u5099\u597d")))})),"boolean"!=typeof M&&M.players.map((function(e){if(e.name!==c)return n.a.createElement("div",{key:e.name,className:"room-player"},n.a.createElement("div",{className:"name"},n.a.createElement("label",null,"ENG"===g?"Name":"\u59d3\u540d"),n.a.createElement("div",{className:"inner"},e.name)),n.a.createElement("div",{className:"role"},n.a.createElement("label",null,"ENG"===g?"Role":"\u968a\u4f0d"),n.a.createElement("div",{className:"inner"},"ATTACK"===e.role?"ENG"===g?"ATTACK":"\u6399\u5206":"ENG"===g?"DEFEND":"\u6253\u5206")),n.a.createElement("div",{className:e.isReady?"ready":"not-ready"},n.a.createElement("label",null,"ENG"===g?"Status":"\u72c0\u614b"),n.a.createElement("div",{className:"inner"},e.isReady?"ENG"===g?"Ready":"\u5df2\u6e96\u5099\u597d":"ENG"===g?"Not ready":"\u672a\u6e96\u5099\u597d")))}))),n.a.createElement("div",{className:"master-number"},n.a.createElement("select",{defaultValue:m.Values.TWO,name:"masterNumber",onChange:function(e){return A(e.target.value)}},n.a.createElement("option",{value:m.Values.TWO},"2"),n.a.createElement("option",{value:m.Values.THREE},"3"),n.a.createElement("option",{value:m.Values.FOUR},"4"),n.a.createElement("option",{value:m.Values.FIVE},"5"),n.a.createElement("option",{value:m.Values.SIX},"6"),n.a.createElement("option",{value:m.Values.SEVEN},"7"),n.a.createElement("option",{value:m.Values.EIGHT},"8"),n.a.createElement("option",{value:m.Values.NINE},"9"),n.a.createElement("option",{value:m.Values.TEN},"10"),n.a.createElement("option",{value:m.Values.JACK},"J"),n.a.createElement("option",{value:m.Values.QUEEN},"Q"),n.a.createElement("option",{value:m.Values.KING},"K"),n.a.createElement("option",{value:m.Values.ACE},"A"),n.a.createElement("option",{value:"JOKER"},"JOKER"))),n.a.createElement("div",{className:"toggle-ready"},n.a.createElement("button",{className:B?"ready":"not-ready",onClick:function(){M&&(e.emit("toggleReady",k),F(!B))}},B?"ENG"===g?"I'm not ready":"\u6211\u6c92\u6e96\u5099\u597d":"ENG"===g?"I'm ready":"\u6211\u6e96\u5099\u597d\u4e86"))):n.a.createElement("div",{className:"home-container"},n.a.createElement("div",{className:"select-lang"},n.a.createElement("select",{name:"language",defaultValue:g,onChange:function(e){b(e.target.value),H.current=e.target.value,_.set("lang",e.target.value)}},n.a.createElement("option",{value:"ENG"},"English"),n.a.createElement("option",{value:"CHN"},"\u4e2d\u6587"))),n.a.createElement("div",{className:"form-container"},n.a.createElement("input",{placeholder:"ENG"===g?"Room":"\u623f\u9593",name:"room",onChange:function(e){f(e.target.value),Y.current=e.target.value}}),n.a.createElement("input",{placeholder:"ENG"===g?"Name":"\u59d3\u540d",name:"name",onChange:function(e){l(e.target.value),x.current=e.target.value}}),n.a.createElement("select",{name:"role",defaultValue:"ATTACK",onChange:function(e){return d(e.target.value)}},n.a.createElement("option",{value:"ATTACK"},"ENG"===g?"Attacking team":"\u6399\u5206"),n.a.createElement("option",{value:"DEFEND"},"ENG"===g?"Defending team":"\u6253\u5206")),n.a.createElement("div",{className:"alert",ref:D}),n.a.createElement("button",{type:"submit",onClick:function(a){return function(a){a.preventDefault(),c&&u&&h?c.length>14?D.current.innerHTML="ENG"===g?"Your name cannot be longer than 14 characters!":"\u60a8\u7684\u59d3\u540d\u4e0d\u80fd\u8d85\u904e14\u500b\u5b57\u7bc0\uff01":e.emit("setName",{name:c,role:u,room:h}):D.current.innerHTML="ENG"===g?"Please fill in all required fields!":"\u8acb\u586b\u5beb\u6240\u6709\u7684\u9078\u9805\uff01"}(a)}},"ENG"===g?"Confirm":"\u78ba\u8a8d")))}var O=window.location.origin.replace(/^http/,"ws"),k=i()(O),P=n.a.createContext(k),A=new E.a;var T=function(){var e=Object(r.useState)(),a=Object(s.a)(e,2),t=a[0],c=a[1];return Object(r.useEffect)((function(){var e=A.get("name"),a=A.get("room"),t=A.get("lang");console.log({name:e,room:a,lang:t}),e&&a&&t&&k.emit("recoverRoom",{name:e,room:a}),k.on("roomRecover",(function(e){var a=e.game;c(a)}))}),[]),t?n.a.createElement(P.Provider,{value:k},n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"warning"},n.a.createElement("p",null,"Your screen size is too small for the game. Please switch to Landscape view or change to a larger device!")),"ENG"===A.get("lang")?n.a.createElement(v,{game:t,name:A.get("name")}):n.a.createElement(C,{game:t,name:A.get("name")}))):n.a.createElement(P.Provider,{value:k},n.a.createElement("div",{className:"App"},n.a.createElement("div",{className:"warning"},n.a.createElement("p",null,"Your screen size is too small for the game. Please switch to Landscape view or change to a larger device!")),n.a.createElement(w,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(T,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[41,1,2]]]);
//# sourceMappingURL=main.b50dc7b5.chunk.js.map